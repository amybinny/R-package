<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Amy Philip (110457611)" />


<title>Tests for partially matched samples (AMS 597 project)</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Tests for partially matched samples (AMS 597 project)</h1>
<h4 class="author">Amy Philip (110457611)</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this vignette, I am explaining about an R package <strong>PMphilip</strong>. The functions in this package executes p-values which helps in filling the missing data in partially matched samples. This package is based on a series of tests mentioned in the publication, <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.5758">‘A Simple and Robust Method for Partially Matched Samples Using the P-Values Pooling Approach’</a> by Pei-Fen Kuan and Bo Huang published in 2013. The p-values generated are using Liptak’s weighted Z-test, Kim et al.’s modified t-statistic, Looney and Jones’s corrected Z-test, Lin and Stivers’s MLE based test under heteroscedasticity, Ekbohm’s MLE-based test under homoscedasticity.</p>
</div>
<div id="disclosure" class="section level2">
<h2>Disclosure</h2>
<p>To create and implement this package successfully, I discussed the project with my friends/classmates Xuliejun Ren (our methodologies are similar, not the codes) and Benjamin Sterling (mainly in clarifying the purpose of tests and implementation of certain tests, considering all possible scenarios).</p>
</div>
<div id="implementation-of-the-package" class="section level2">
<h2>Implementation of the package</h2>
<p>The p-value pooling works at its best when the data is Gaussian. I can check for this using the command <strong>qnorm()</strong> in R. If I get a line y=x (approximately), then I can conclude the data is Gaussian. If the data I have is not Gaussian or t-distributed, then it is better to apply combining the non-parametric Wilcoxon signed-rank and the Mann-Whitney statistics for discrete or ranked data.</p>
<p>The input variables here are the matched sample vectors (<strong>x,y</strong>), with missing values. Tests mentioned in the introduction, uses statistical methods to generate p-values to help impute appropriate missing values. Once these missing values are imputed, the data can be carried on for any further procedure it was meant to do, which could not have been done with missing values. Say for example, I consider expressed microRNA data of tumor sample and the corresponding expressed microRNA data of normal tissue samples (explanation for he codes in the package is also based on these tumor and normal samples). These are matched samples. Our tests can impute missing values, if there are missing data.</p>
<p>This package can be installed by running <strong>install(“PMphilip”,<em>provide the path of directory where the package is installed</em>)</strong> in the console. Once the package is installed in R, the package can be loaded the using <strong>library()</strong>. An example of the path is shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install(&quot;PMphilip&quot;,&quot;C:/Users...&quot;)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PMphilip)</span></code></pre></div>
<p>Once the tar.gz file is downloaded and the path is known, remove the # symbol from above and execute the rest.</p>
</div>
<div id="parameters-and-common-codes" class="section level2">
<h2>Parameters and common codes:</h2>
<p>For the tests, the parameters <strong>x</strong> and <strong>y</strong> are matched samples. The data is majorly diving into paired and unpaired samples, based on the missing data. The next parameter is <strong>alternative</strong>. Based on the two-sided or one-sided , “two.sided” (default), “greater”, “less” can be used. The last parameter used her is <strong>a</strong>. This is mainly used here to check the amount of variance level allowed to perform these tests. I have provided <strong>0.01</strong> as default significance level.</p>
<p>In each of the tests, the samples are divided into x which has a matched pair (<strong>x_both_samples</strong>), x without a matched pair (<strong>x_samples_part</strong>), y which has a matched pair (<strong>y_both_samples</strong>) and y without a matched pair (<strong>y_samples_part</strong>). The number of matched pairs is denoted by <strong>n1</strong>, number of unpaired <strong>x</strong> is <strong>n2</strong>, number of unpaired <strong>y</strong> is <strong>n3</strong>. A conditional is passed to check whether the variance of samples are equal or not. I use F-test to check this using <strong>var.test()</strong> in R, with significance level <strong>a</strong> mentioned in parameters and a logical argument <strong>var.eq</strong> is defined to be <strong>TRUE</strong>, if the variance turns out to be equal (that is the p-value obtained should be greater than equal to <strong>a</strong>) and <strong>var.eq</strong> is defined to be <strong>FALSE</strong>, if the variance is unequal (that is the p-value obtained should be less than <strong>a</strong>).</p>
</div>
<div id="warnings-and-errors" class="section level2">
<h2>Warnings and Errors:</h2>
<ul>
<li><p>If I do not have enough data, which is at least 2 samples for each <strong>x</strong> and <strong>y</strong>, then I get an error.</p></li>
<li><p>If there are no missing values, then an error occurs.</p></li>
<li><p>If the length of the numeric vector <strong>x</strong> is different from the length of the numeric vector <strong>y</strong>, then an error occurs.</p></li>
<li><p>If I do not have paired samples, which is at least 2, then I perform a <strong>t.test()</strong> with arguments <strong>paired=FALSE</strong> and <strong>var.equal=var.eq</strong>.</p></li>
<li><p>If I do not have unpaired samples, which is at least 2, then I perform a <strong>t.test()</strong> with arguments <strong>paired=TRUE</strong> and <strong>var.equal=var.eq</strong>.</p></li>
</ul>
<p>Now, let us look at each of the tests separately.</p>
<div id="liptaks-test-my.liptak" class="section level3">
<h3>Liptak’s test (<strong>my.Liptak()</strong>)</h3>
<p>Liptak test is based on a weighted Z-test. This test works well for equal variances. The p-value for the Z-statistic is given by <span class="math display">\[1-\Phi \Big(\dfrac{w1*z1+w2*z2}{\sqrt{(w1^2+w2^2)}}\Big)\]</span>. In the function, <strong>p1</strong> is the p-value for <strong>n1</strong> paired samples, and <strong>p2</strong> be the corresponding p-value computed from the <strong>n2</strong> and <strong>n3</strong> unpaired samples. This is calculated using <strong>t.test</strong> with arguments <strong>var.equal=var.eq</strong>. logical argument <strong>paired</strong> based on the samples. <strong>w1</strong> and <strong>w2</strong> are corresponding weights which are the square roots of the corresponding weights. <strong>zi=<span class="math inline">\(\Phi^{-1}\)</span>(1-pi)</strong> for i=1,2. P-values pooling is only meaningful if <strong>p1</strong> and <strong>p2</strong> are computed from one-sided hypothesis tests to avoid directional conflict. The two-sided p-value is then obtained by first calculating p-value for alternative greater, say <strong>p</strong> and the two-sided p-value will be <strong>2p</strong> if <strong>p&lt;1/2</strong> and <strong>2(1-p)</strong> otherwise. An example applying this test is provided below:</p>
<p>I consider an example with data variability up to significance level <strong>a=0.05</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">8</span>)<span class="sc">$</span>weight</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>weight</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value <span class="co">#0.063&gt;0.05 means that data has equal variance. SO the test works well here.</span></span></code></pre></div>
<pre><code>## [1] 0.06307162</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Liptak</span>(x,y,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="at">a=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="kim-et-al.s-test-my.kim" class="section level3">
<h3>Kim et al.’s test (<strong>my.Kim()</strong>)</h3>
<p>The modified t-statistic of Kim et al. defined as <span class="math display">\[\dfrac{n1*D+nH*(T-N)}{\sqrt {n1*SD\_D^2+nH^2*(SD\_N^2/n3+SD\_T^2/n2)}}\]</span> where, <strong>D</strong> is the mean difference of the <strong>n1</strong> paired samples, <strong>T</strong> and <strong>N</strong> are the mean of unpaired samples for the <strong>n2</strong> and <strong>n3</strong> unmatched samples, respectively. <strong>SD_D</strong>, <strong>SD_T</strong> and <strong>SD_N</strong> are the corresponding sample standard deviations, and <strong>nH</strong> is the harmonic mean of <strong>n2</strong> and <strong>n3</strong>. Under null hypothesis the statistic follows standard normal distribution. Hence the p-value is calculated using <strong>pnorm</strong>. An example is given as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">8</span>)<span class="sc">$</span>weight</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>weight</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">14</span><span class="sc">:</span><span class="dv">26</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Kim</span>(x,y,<span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>, <span class="at">a=</span><span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="looney-and-jones-test-my.looney.jones" class="section level3">
<h3>Looney and Jones test (<strong>my.Looney.Jones()</strong>)</h3>
<p>Looney and Jones is based on a modified variance estimation of the standard Z-test by accounting for the correlation among the <strong>n1</strong> matched pairs. This modifies Z-statistic is defined as <span class="math display">\[\dfrac{T\_-N\_}{\sqrt{SD\_T\_^2/(n1+n2)+SD\_N\_^2/(n1+n3)-2*n1*SD\_TN1/((n1+n2)*(n1+n3))}}\]</span></p>
<p>where, <strong>T_</strong> and <strong>N_</strong> are the mean of paired <strong>x</strong> samples and unpaired <strong>y</strong> for the <strong>n1 + n2</strong> and <strong>n1 + n3</strong> matched and unmatched samples combined, respectively. <strong>SD_T</strong> and <strong>SD_N_</strong> are the corresponding sample standard deviations, and <strong>STN1</strong> is the sample covariance of the <strong>n1</strong> paired samples. Under null hypothesis, the statistic follows a standard normal distribution. An example illustrating the test is given as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">8</span>)<span class="sc">$</span>weight</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>weight</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">14</span><span class="sc">:</span><span class="dv">26</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Looney.Jones</span>(x,y,<span class="at">alternative=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1.583857e-08</code></pre>
</div>
<div id="lin-and-stiverss-test-my.lin.stivers" class="section level3">
<h3>Lin and Stivers’s test (<strong>(my.Lin.Stivers)</strong>)</h3>
<p>Lin and Stiver’s test statistic is based on the modified maximum likelihood estimator. This test is defined for heteroscedastic case, that is when the variances are not equal. The statistic is given by <span class="math display">\[\dfrac{f*(T1-T)-g*(N1-N)+T-N}{\sqrt{V1}}\]</span> where, <strong>T1</strong> and <strong>N1</strong> are the mean for paired and unpaired <strong>x</strong> for the <strong>n1</strong> paired samples. <strong>ST1</strong> and <strong>SN1</strong> are the corresponding sample standard deviations, respectively, <strong>V1</strong>, <strong>f</strong>, <strong>g</strong> and <strong>r</strong> are constants which can be found in the paper provided in the introduction. Under the null hypothesis, the statistic is approximately distributed as <strong>t</strong> with <strong>n1</strong> degrees of freedom. A warning code is provided in the function to state that the test works well when the variance in the data is unequal. An example illustrating the test is given below.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">8</span>)<span class="sc">$</span>weight</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>weight</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">14</span><span class="sc">:</span><span class="dv">26</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Lin.Stivers</span>(x,y,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="at">a=</span><span class="fl">0.02</span>)</span></code></pre></div>
<pre><code>## Warning in my.Lin.Stivers(x, y, alternative = &quot;two.sided&quot;, a = 0.02): Lin and
## Stivers test works best for the heteroscedastic case, that is when variances are
## not equal. The data provided here has equal varaince</code></pre>
<pre><code>## [1] 2.020606e-14</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">8</span>)<span class="sc">$</span>weight</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>weight</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>]<span class="ot">&lt;-</span><span class="cn">NA</span>; y[<span class="dv">14</span><span class="sc">:</span><span class="dv">20</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Lin.Stivers</span>(x,y)</span></code></pre></div>
<pre><code>## Warning in my.Lin.Stivers(x, y): Lin and Stivers test works best for the
## heteroscedastic case, that is when variances are not equal. The data provided
## here has equal varaince</code></pre>
<pre><code>## [1] 2.220446e-16</code></pre>
</div>
<div id="ekbohms-test-my.ekbohm" class="section level3">
<h3>Ekbohm’s test (<strong>my.Ekbohm()</strong>)</h3>
<p>Ekbohm’s test statistic is based on the modified maximum likelihood estimator. This test is defined for homoscedastic case, that is when the variances are equal. This MLE based test statistic is given as <span class="math display">\[\dfrac{f\_*(T1-T)-g\_*(N1-N)+T-N}{\sqrt{V1\_}}\]</span> where <strong>V1_</strong>, <strong>f_</strong> and <strong>g_</strong> are constants which can be found in the paper that is provided in the introduction. A warning code is provided in the function to state that the test works well when the variances in the data are equal. An example illustrating the test is given below.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">8</span>)<span class="sc">$</span>weight</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">10</span>)<span class="sc">$</span>weight</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">14</span><span class="sc">:</span><span class="dv">16</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value <span class="co">#0.063&gt;0.05 means that data has equal variance. So the test works well here.</span></span></code></pre></div>
<pre><code>## [1] 0.06307162</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Ekbohm</span>(x,y, <span class="at">a=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(mvtnorm)){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;mvtnorm&quot;</span>)}</span></code></pre></div>
<pre><code>## Loading required package: mvtnorm</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>); </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="dv">4</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">rmvnorm</span>(<span class="dv">100</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),s)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>d[,<span class="dv">1</span>]; y<span class="ot">&lt;-</span>d[,<span class="dv">2</span>]</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">14</span><span class="sc">:</span><span class="dv">26</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">my.Ekbohm</span>(x,y, <span class="at">a=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## Warning in my.Ekbohm(x, y, a = 0.5): Ekbohm test works best for the
## homoscedastic case, that is when variances are equal. The data provided here has
## unequal varaince</code></pre>
<pre><code>## [1] 0.6465846</code></pre>
</div>
</div>
<div id="thank-you" class="section level2">
<h2>Thank you</h2>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
